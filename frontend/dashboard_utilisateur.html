<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dashboard Utilisateur - Gestion Matériel</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/dashboard_styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="dashboard-user">
  <!-- Sidebar -->
  <nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
      <div class="logo-container">
        <img src="assets/icon/extracted_image.png" alt="Logo" class="logo-image" style="width: 50px; height: 50px; object-fit: contain;">
        <h2 class="logo-text">Utilisateur</h2>
      </div>
      <button class="sidebar-toggle" onclick="toggleSidebar()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="sidebar-menu">
      <div class="menu-section">
        <h3 class="menu-title">Gestion</h3>
        <a href="#" class="menu-item active" data-section="dashboard">
          <i class="fas fa-tachometer-alt"></i>
          <span>Tableau de bord</span>
        </a>
        <a href="#" class="menu-item" data-section="materiel">
          <i class="fas fa-desktop"></i>
          <span>Matériel</span>
        </a>
        <a href="#" class="menu-item" data-section="allocation">
          <i class="fas fa-handshake"></i>
          <span>Allocations</span>
        </a>
        <a href="#" class="menu-item" data-section="maintenance">
          <i class="fas fa-wrench"></i>
          <span>Maintenance</span>
        </a>
      </div>
      
      <div class="menu-section">
        <h3 class="menu-title">Rapports</h3>
        <a href="#" class="menu-item" data-section="reporting">
          <i class="fas fa-chart-line"></i>
          <span>Statistiques</span>
        </a>
      </div>
      
      <div class="menu-section">
        <h3 class="menu-title">Support</h3>
        <a href="#" class="menu-item" data-section="chatbot">
          <i class="fas fa-robot"></i>
          <span>Assistant IA</span>
        </a>
      </div>
    </div>
    
    <div class="sidebar-footer">
      <button class="logout-btn" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i>
        <span>Déconnexion</span>
      </button>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="main-wrapper">
    <!-- Top Header -->
    <header class="top-header">
      <div class="header-left">
        <button class="menu-toggle" onclick="toggleSidebar()">
          <i class="fas fa-bars"></i>
        </button>
        <h1 class="page-title">Tableau de bord</h1>
      </div>
      
      <div class="header-right">
        <div class="user-info">
          <div class="user-avatar">
            <i class="fas fa-user"></i>
          </div>
          <div class="user-details">
            <span class="user-name">Employé Média</span>
            <span class="user-role">Employé Média</span>
          </div>
        </div>
      </div>
    </header>

    <!-- Main Content Area -->
    <main class="main-content">
      <!-- Dashboard Overview -->
      <section id="dashboard-section" class="content-section active">
        <div class="section-header">
          <h2>Vue d'ensemble</h2>
          <p>Bienvenue dans votre tableau de bord employé média</p>
        </div>
        
        <!-- Statistics Cards -->
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-desktop"></i>
            </div>
            <div class="stat-content">
              <h3 class="stat-number">12</h3>
              <p class="stat-label">Matériels disponibles</p>
            </div>
            <div class="stat-trend positive">
              <i class="fas fa-arrow-up"></i>
              <span>+3</span>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-handshake"></i>
            </div>
            <div class="stat-content">
              <h3 class="stat-number">5</h3>
              <p class="stat-label">Mes allocations</p>
            </div>
            <div class="stat-trend neutral">
              <i class="fas fa-minus"></i>
              <span>0</span>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-wrench"></i>
            </div>
            <div class="stat-content">
              <h3 class="stat-number">2</h3>
              <p class="stat-label">Maintenance en cours</p>
            </div>
            <div class="stat-trend negative">
              <i class="fas fa-arrow-down"></i>
              <span>-1</span>
            </div>
          </div>
          
          <div class="stat-card">
            <div class="stat-icon">
              <i class="fas fa-clock"></i>
            </div>
            <div class="stat-content">
              <h3 class="stat-number">3</h3>
              <p class="stat-label">Demandes en attente</p>
            </div>
            <div class="stat-trend positive">
              <i class="fas fa-arrow-up"></i>
              <span>+1</span>
            </div>
          </div>
        </div>
        
        <!-- Quick Actions -->
        <div class="quick-actions">
          <h3>Actions rapides</h3>
          <div class="actions-grid">
            <button class="action-btn" onclick="showSection('materiel')">
              <i class="fas fa-search"></i>
              <span>Rechercher du matériel</span>
            </button>
            <button class="action-btn" onclick="showSection('allocation')">
              <i class="fas fa-plus"></i>
              <span>Demander une allocation</span>
            </button>
            <button class="action-btn" onclick="showSection('maintenance')">
              <i class="fas fa-tools"></i>
              <span>Signaler un problème</span>
            </button>
            <button class="action-btn" onclick="showSection('reporting')">
              <i class="fas fa-chart-bar"></i>
              <span>Voir mes statistiques</span>
            </button>
          </div>
        </div>
      </section>

      <!-- Material Section -->
      <section id="materiel-section" class="content-section">
        <div class="section-header">
          <h2>Gestion du matériel</h2>
          <button class="btn-primary" onclick="addMateriel()">
            <i class="fas fa-plus"></i>
            Ajouter du matériel
          </button>
        </div>
        
        <!-- Add Material Form -->
        <div class="form-card">
          <h3>Ajouter un nouveau matériel</h3>
          <form id="addMaterielForm" class="modern-form">
            <div class="form-row">
              <div class="form-group">
                <label for="nom">Nom du matériel</label>
                <input type="text" id="nom" placeholder="Ex: Caméra Sony HD" required />
              </div>
              <div class="form-group">
                <label for="type">Type</label>
                <select id="type" required>
                  <option value="">Sélectionner un type</option>
                  <option value="caméra">Caméra</option>
                  <option value="microphone">Microphone</option>
                  <option value="ordinateur">Ordinateur</option>
                  <option value="écran">Écran</option>
                  <option value="autre">Autre</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="etat">État</label>
                <select id="etat" required>
                  <option value="disponible">Disponible</option>
                  <option value="en panne">En panne</option>
                  <option value="affecté">Affecté</option>
                  <option value="maintenance">En maintenance</option>
                </select>
              </div>
              <div class="form-group">
                <label for="localisation">Localisation</label>
                <input type="text" id="localisation" placeholder="Ex: Bureau A1, Studio 1" />
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-primary">
                <i class="fas fa-plus"></i>
                Ajouter
              </button>
              <button type="reset" class="btn-secondary">
                <i class="fas fa-undo"></i>
                Réinitialiser
              </button>
            </div>
          </form>
        </div>
        
        <!-- Material List -->
        <div class="data-section">
          <h3>Liste du matériel</h3>
          <div id="materielList" class="data-table-container">
            <div class="loading-spinner">Chargement...</div>
          </div>
        </div>
      </section>

      <!-- Allocation Section -->
      <section id="allocation-section" class="content-section">
        <div class="section-header">
          <h2>Allocation & suivi</h2>
          <button class="btn-primary" onclick="addAllocation()">
            <i class="fas fa-plus"></i>
            Nouvelle demande
          </button>
        </div>
        
        <!-- Allocation Request Form -->
        <div class="form-card">
          <h3>Demande d'allocation</h3>
          <form id="demandeAllocationForm" class="modern-form">
            <div class="form-row">
              <div class="form-group">
                <label for="materielId">Matériel souhaité</label>
                <select id="materielId" required>
                  <option value="">Sélectionner un matériel</option>
                  <option value="1">Caméra Sony HD</option>
                  <option value="2">Microphone Shure</option>
                  <option value="3">PC Portable Dell</option>
                </select>
              </div>
              <div class="form-group">
                <label for="beneficiaire">Bénéficiaire</label>
                <input type="text" id="beneficiaire" placeholder="Votre nom ou service" required />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="dateDebut">Date de début</label>
                <input type="date" id="dateDebut" required />
              </div>
              <div class="form-group">
                <label for="dateFin">Date de fin</label>
                <input type="date" id="dateFin" required />
              </div>
            </div>
            <div class="form-group">
              <label for="raison">Raison de la demande</label>
              <textarea id="raison" placeholder="Décrivez brièvement la raison de votre demande..." rows="3"></textarea>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-primary">
                <i class="fas fa-paper-plane"></i>
                Soumettre la demande
              </button>
              <button type="reset" class="btn-secondary">
                <i class="fas fa-undo"></i>
                Réinitialiser
              </button>
            </div>
          </form>
        </div>
        
        <!-- Allocation History -->
        <div class="data-section">
          <h3>Historique des allocations</h3>
          <div id="historiqueAllocations" class="data-table-container">
            <div class="loading-spinner">Chargement...</div>
          </div>
        </div>
      </section>

      <!-- Maintenance Section -->
      <section id="maintenance-section" class="content-section">
        <div class="section-header">
          <h2>Maintenance</h2>
          <button class="btn-primary" onclick="addMaintenance()">
            <i class="fas fa-plus"></i>
            Nouveau signalement
          </button>
        </div>
        
        <!-- Maintenance Form -->
        <div class="form-card">
          <h3>Signaler un problème</h3>
          <form id="maintenanceForm" class="modern-form">
            <div class="form-row">
              <div class="form-group">
                <label for="materielIdMaintenance">Matériel concerné</label>
                <select id="materielIdMaintenance" required>
                  <option value="">Sélectionner un matériel</option>
                  <option value="1">Caméra Sony HD</option>
                  <option value="2">Microphone Shure</option>
                  <option value="3">PC Portable Dell</option>
                </select>
              </div>
              <div class="form-group">
                <label for="priorite">Priorité</label>
                <select id="priorite" required>
                  <option value="basse">Basse</option>
                  <option value="normale">Normale</option>
                  <option value="haute">Haute</option>
                  <option value="critique">Critique</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label for="description">Description du problème</label>
              <textarea id="description" placeholder="Décrivez en détail le problème rencontré..." rows="4" required></textarea>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label for="localisationProbleme">Localisation</label>
                <input type="text" id="localisationProbleme" placeholder="Où se trouve le matériel ?" />
              </div>
              <div class="form-group">
                <label for="contact">Contact d'urgence</label>
                <input type="tel" id="contact" placeholder="Votre numéro de téléphone" />
              </div>
            </div>
            <div class="form-actions">
              <button type="submit" class="btn-primary">
                <i class="fas fa-paper-plane"></i>
                Soumettre le signalement
              </button>
              <button type="reset" class="btn-secondary">
                <i class="fas fa-undo"></i>
                Réinitialiser
              </button>
            </div>
          </form>
        </div>
        
        <!-- Maintenance List -->
        <div class="data-section">
          <h3>Mes signalements</h3>
          <div id="listeMaintenance" class="data-table-container">
            <div class="loading-spinner">Chargement...</div>
          </div>
        </div>
      </section>

      <!-- Reporting Section -->
      <section id="reporting-section" class="content-section">
        <div class="section-header">
          <h2>Statistiques et rapports</h2>
          <button class="btn-secondary" onclick="exportRapport()">
            <i class="fas fa-download"></i>
            Exporter le rapport
          </button>
        </div>
        
        <!-- Charts -->
        <div class="reports-grid">
          <div class="report-card">
            <h3>Utilisation du matériel</h3>
            <canvas id="materielChart" width="400" height="200"></canvas>
          </div>
          <div class="report-card">
            <h3>Allocations par mois</h3>
            <canvas id="allocationChart" width="400" height="200"></canvas>
          </div>
        </div>
        
        <!-- Summary Stats -->
        <div class="summary-stats">
          <div class="summary-card">
            <h4>Total des allocations</h4>
            <p class="summary-number">24</p>
            <p class="summary-period">Cette année</p>
          </div>
          <div class="summary-card">
            <h4>Matériel le plus utilisé</h4>
            <p class="summary-text">Caméra Sony HD</p>
            <p class="summary-period">15 utilisations</p>
          </div>
          <div class="summary-card">
            <h4>Maintenance effectuée</h4>
            <p class="summary-number">8</p>
            <p class="summary-period">Cette année</p>
          </div>
        </div>
      </section>

      <!-- Chatbot Section -->
      <section id="chatbot-section" class="content-section">
        <div class="section-header">
          <h2>Assistant IA</h2>
        </div>
        <div class="chatbot-container">
          <div class="chatbot-messages" id="chatbotMessages">
            <div class="message bot-message">
              <div class="message-content">
                <p>Bonjour ! Je suis votre assistant intelligent. Je peux vous aider avec vos demandes d'équipement, rapports de panne, et bien plus encore. Comment puis-je vous aider aujourd'hui ?</p>
              </div>
            </div>
          </div>
          <div class="chatbot-input">
            <input type="text" id="chatbotInput" placeholder="Tapez votre message..." class="chat-input">
            <button onclick="sendChatbotMessage()" class="btn btn-primary">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Toast Notifications -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- Floating Action Button -->
  <button class="fab" id="fab" onclick="quickAction()">
    <i class="fas fa-plus"></i>
  </button>

  <script src="js/dashboard.js"></script>
  <script src="js/materiel.js"></script>
  <script src="js/allocation.js"></script>
  <script src="js/maintenance.js"></script>
  <script src="js/reporting.js"></script>
          <script src="js/api-service.js"></script>
        <script src="js/user-dashboard.js"></script>
</body>
</html>
